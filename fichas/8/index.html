<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <meta property="og:title" content="Programação Imperativa">
    <meta property="og:description" content="Resolução de exercícios, fichas e testes.">
    <meta property="og:image" content="./C-Logo.png">
    <meta property="og:image:secure_url" content="./C-Logo.png">
    <title>
      
       
        Ficha 8 |
       Programação Imperativa</title>
    <link rel="stylesheet" href="/Programacao-Imperativa/assets/css/main.css">
    <link rel="shortcut icon" href="/Programacao-Imperativa/favicon.ico" >
    <script type="text/javascript">

      // Wait for the page to load first
      window.onload = function() {

        //Get a reference to the link on the page
        // with an id of "mylink"
        var a = document.getElementById("code-overlay");
        a.style.display = "flex";

        //Set code to run when the link is clicked
        // by assigning a function to "onclick"
        a.onclick = function() {

          // Your code here...
          a.remove();

          //If you don't want the link to actually 
          // redirect the browser to another page,
          // then return false at the end of this block.
          // Note that this also prevents event bubbling,
          // which is probably what we want here, but won't 
          // always be the case.
          return false;
        }
      }
    </script>
  </head>
  <body>
    <div class="bg-darker-gray w-full min-h-screen text-white flex flex-col">
      <header class="bg-dark-gray p-8 lg:px-14 flex flex-col md:flex-row gap-6 justify-between items-center">
        <div class="flex flex-col items-center sm:flex-row sm:items-start gap-5 sm:gap-10">
          <a href=/Programacao-Imperativa/ class="flex-none">
            <img src=/Programacao-Imperativa/C-Logo.png class="relative h-16 top-2 md:items-center">
          </a>
          <div class="space-y-2 text-center sm:text-left">
            <p class="text-4xl font-bold">Programação Imperativa</p>
            <p class="text-lg font-light">Resolução de exercícios, fichas e testes.</p>
          </div>
        </div>
        
          <!--
          <div class="flex gap-3 md:gap-6 justify-end items-center flex-col lg:flex-row w-full md:w-auto">
            <a href=/Programacao-Imperativa/50q/index.html class="bg-blue-800 hover:bg-blue-600 p-5 w-full sm:w-1/2 md:w-36 flex justify-center items-center rounded-xl">
              <p class="uppercase font-bold">50 Questões</p>
            </a>
            <a href=/Programacao-Imperativa/fichas/index.html class="bg-blue-800 hover:bg-blue-600 p-5 w-full sm:w-1/2 md:w-36 flex justify-center items-center rounded-xl">
              <p class="uppercase font-bold">Fichas</p>
            </a>
          </div>
          -->
          <a href="../" class="bg-blue-800 hover:bg-blue-600 p-5 w-full sm:w-1/2 md:w-36 flex justify-center items-center rounded-xl">
            <p class="uppercase font-bold">ᐸ Voltar</p>
          </a>
        
      </header>
      <div class="px-3 py-10 sm:p-20 flex-grow">
      

<div class="flex flex-col gap-3">
  <div class="flex justify-between flex-col md:flex-row items-center gap-8 md:items-start">
    <div class="md:w-2/3 xl:w-1/2 px-5 space-y-2 self-start">
      <h1 class="text-2xl md:text-3xl xl:text-4xl font-bold">
        Ficha : 
      </h1>
    </div>
    <div class="flex gap-5">
       
        
        
        <a href=/Programacao-Imperativa/fichas/-1 class="flex flex-col justify-center items-center w-24 h-24 rounded-full bg-purple-800 hover:bg-purple-600">
          <p class="text-2xl font-bold"><</p>
          <p>Anterior</p>
        </a>
      
      
        
        
        <a href=/Programacao-Imperativa/fichas/1 class="flex flex-col justify-center items-center w-24 h-24 rounded-full bg-purple-800 hover:bg-purple-600">
          <p class="text-2xl font-bold">></p>
          <p>Seguinte</p>
        </a>
      
    </div>
  </div>
  <div class="md:px-20" id="resolution">
    
    <h1 id="1-considere-o-seguinte-tipo-de-dados-para-representar-frações">1) Considere o seguinte tipo de dados para representar frações</h1>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>data Frac = F Integer Integer
</code></pre></div></div>

<h2 id="a-defina-a-função-normaliza--frac---frac-que-dada-uma-fracção-calcula-uma-fracção-equivalente-irredutível-e-com-o-denominador-positivo-por-exemplo-normaliza-f--33--51-deve-retornar-f-11-17-e-normaliza-f-50--5-deve-retornar-f--10-1-sugere-se-que-comece-por-definir-primeiro-a-função-mdc--integer---integer---integer-que-calcula-o-máximo-divisor-comum-entre-dois-números-baseada-na-seguinte-propriedade-atribuida-a-euclides-mdc-x-y--mdc-xy-y--mdc-x-yx">a) Defina a função <code class="language-plaintext highlighter-rouge">normaliza :: Frac -&gt; Frac</code> que dada uma fracção calcula uma fracção equivalente, irredutível, e com o denominador positivo. Por exemplo, <code class="language-plaintext highlighter-rouge">normaliza (F (-33) (-51))</code> deve retornar <code class="language-plaintext highlighter-rouge">F 11 17</code> e <code class="language-plaintext highlighter-rouge">normaliza (F 50 (-5))</code> deve retornar <code class="language-plaintext highlighter-rouge">F (-10) 1</code>. Sugere-se que comece por definir primeiro a função <code class="language-plaintext highlighter-rouge">mdc :: Integer -&gt; Integer -&gt; Integer</code> que calcula o máximo divisor comum entre dois números, baseada na seguinte propriedade (atribuida a Euclides): <code class="language-plaintext highlighter-rouge">mdc x y == mdc (x+y) y == mdc x (y+x)</code></h2>

<div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mdc</span> <span class="o">::</span> <span class="kt">Integer</span> <span class="o">-&gt;</span> <span class="kt">Integer</span> <span class="o">-&gt;</span> <span class="kt">Integer</span>
<span class="n">mdc</span> <span class="n">a</span> <span class="n">b</span> <span class="o">=</span> <span class="n">last</span> <span class="p">[</span><span class="n">n</span> <span class="o">|</span> <span class="n">n</span> <span class="o">&lt;-</span> <span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="p">(</span><span class="n">min</span> <span class="n">a</span> <span class="n">b</span><span class="p">)]</span> <span class="p">,</span> <span class="n">a</span> <span class="p">`</span><span class="n">mod</span><span class="p">`</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">b</span> <span class="p">`</span><span class="n">mod</span><span class="p">`</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">normaliza</span> <span class="o">::</span> <span class="kt">Frac</span> <span class="o">-&gt;</span> <span class="kt">Frac</span>
<span class="n">normaliza</span> <span class="p">(</span><span class="kt">F</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="kt">F</span> <span class="p">((</span><span class="n">abs</span> <span class="n">a</span><span class="p">)</span> <span class="p">`</span><span class="n">div</span><span class="p">`</span> <span class="n">x</span><span class="p">)</span> <span class="p">(</span><span class="n">bX</span> <span class="p">`</span><span class="n">div</span><span class="p">`</span> <span class="n">x</span><span class="p">)</span>
    <span class="kr">where</span> <span class="n">x</span> <span class="o">=</span> <span class="n">mdc</span> <span class="p">(</span><span class="n">abs</span> <span class="n">a</span><span class="p">)</span> <span class="p">(</span><span class="n">abs</span> <span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="kr">if</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="kr">then</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="kr">else</span> <span class="mi">1</span><span class="p">)</span>
          <span class="n">bX</span> <span class="o">|</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">=</span> <span class="o">-</span><span class="n">b</span>
             <span class="o">|</span> <span class="n">otherwise</span> <span class="o">=</span> <span class="n">b</span>
</code></pre></div></div>

<h2 id="b-defina-frac-como-instância-da-classe-eq">b) Defina <code class="language-plaintext highlighter-rouge">Frac</code> como instância da classe <code class="language-plaintext highlighter-rouge">Eq</code>.</h2>

<div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">instance</span> <span class="kt">Eq</span> <span class="kt">Frac</span> <span class="kr">where</span>
    <span class="p">(</span><span class="kt">F</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="kt">F</span> <span class="n">c</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">d</span> <span class="o">==</span> <span class="n">c</span> <span class="o">*</span> <span class="n">b</span>
</code></pre></div></div>

<h2 id="c-defina-frac-como-instância-da-classe-ord">c) Defina <code class="language-plaintext highlighter-rouge">Frac</code> como instância da classe <code class="language-plaintext highlighter-rouge">Ord</code>.</h2>

<div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">instance</span> <span class="kt">Ord</span> <span class="kt">Frac</span> <span class="kr">where</span>
    <span class="p">(</span><span class="kt">F</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="kt">F</span> <span class="n">c</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">d</span> <span class="o">&lt;=</span> <span class="n">c</span> <span class="o">*</span> <span class="n">b</span>
</code></pre></div></div>

<h2 id="d-defina-frac-como-instância-da-classe-show-de-forma-a-que-cada-fracção-seja-apresentada-por-numeradordenominador">d) Defina <code class="language-plaintext highlighter-rouge">Frac</code> como instância da classe <code class="language-plaintext highlighter-rouge">Show</code>, de forma a que cada fracção seja apresentada por <em>(numerador/denominador)</em>.</h2>

<div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">instance</span> <span class="kt">Show</span> <span class="kt">Frac</span> <span class="kr">where</span>
    <span class="n">show</span> <span class="p">(</span><span class="kt">F</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="n">show</span> <span class="n">a</span> <span class="o">++</span> <span class="s">"/"</span> <span class="o">++</span> <span class="n">show</span> <span class="n">b</span>
</code></pre></div></div>

<h2 id="e-defina-frac-como-instância-da-classe-num-relembre-que-a-classe-num-tem-a-seguinte-definição">e) Defina <code class="language-plaintext highlighter-rouge">Frac</code> como instância da classe <code class="language-plaintext highlighter-rouge">Num</code>. Relembre que a classe <code class="language-plaintext highlighter-rouge">Num</code> tem a seguinte definição:</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class (Eq a, Show a) =&gt; Num a where
    (+), (*), (-) :: a -&gt; a -&gt; a
    negate, abs, signum :: a -&gt; a
    fromInteger :: Integer -&gt; a
</code></pre></div></div>

<div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">instance</span> <span class="kt">Num</span> <span class="kt">Frac</span> <span class="kr">where</span>
    <span class="c1">-- (+), (*), (-) :: a -&gt; a -&gt; a</span>
    <span class="c1">-- negate, abs, signum :: a -&gt; a</span>
    <span class="c1">-- fromInteger :: Integer -&gt; a</span>
    <span class="p">(</span><span class="kt">F</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="kt">F</span> <span class="n">c</span> <span class="n">d</span><span class="p">)</span> <span class="o">|</span> <span class="n">b</span> <span class="o">==</span> <span class="n">d</span> <span class="o">=</span> <span class="n">normaliza</span> <span class="o">$</span> <span class="kt">F</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span> <span class="n">b</span>
                      <span class="o">|</span> <span class="n">otherwise</span> <span class="o">=</span> <span class="n">normaliza</span> <span class="o">$</span> <span class="kt">F</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">d</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">c</span><span class="p">)</span> <span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">d</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">-</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">negate</span> <span class="n">y</span>
    <span class="p">(</span><span class="kt">F</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="kt">F</span> <span class="n">c</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="kt">F</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">c</span><span class="p">)</span> <span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">d</span><span class="p">)</span>
    <span class="n">negate</span> <span class="p">(</span><span class="kt">F</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="kt">F</span> <span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="p">)</span> <span class="n">b</span>
    <span class="n">abs</span> <span class="p">(</span><span class="kt">F</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="kt">F</span> <span class="p">(</span><span class="n">abs</span> <span class="n">a</span><span class="p">)</span> <span class="p">(</span><span class="n">abs</span> <span class="n">b</span><span class="p">)</span>
    <span class="n">signum</span> <span class="p">(</span><span class="kt">F</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span> <span class="o">|</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">=</span> <span class="mi">0</span>
                   <span class="o">|</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">=</span> <span class="mi">1</span>
                   <span class="o">|</span> <span class="n">otherwise</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">fromInteger</span> <span class="n">x</span> <span class="o">=</span> <span class="kt">F</span> <span class="n">x</span> <span class="mi">1</span>
</code></pre></div></div>

<h2 id="f-defina-uma-função-que-dada-uma-fracção-f-e-uma-lista-de-fracções-l-selecciona-de-l-os-elementos-que-são-maiores-do-que-o-dobro-de-f">f) Defina uma função que, dada uma fracção <code class="language-plaintext highlighter-rouge">f</code> e uma lista de fracções <code class="language-plaintext highlighter-rouge">l</code>, selecciona de <code class="language-plaintext highlighter-rouge">l</code> os elementos que são maiores do que o dobro de <code class="language-plaintext highlighter-rouge">f</code>.</h2>

<div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">maioresQueDobro</span> <span class="o">::</span> <span class="kt">Frac</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">Frac</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">Frac</span><span class="p">]</span>
<span class="n">maioresQueDobro</span> <span class="n">f</span> <span class="n">l</span> <span class="o">=</span> <span class="n">filter</span> <span class="p">((</span><span class="o">&lt;</span><span class="p">)</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">f</span><span class="p">))</span> <span class="n">l</span>
</code></pre></div></div>

<h1 id="2-relembre-o-tipo-definido-na-ficha-7-para-representar-expressões-inteiras-uma-possível-generalização-desse-tipo-de-dados-será-considerar-expressões-cujas-constantes-são-de-um-qualquer-tipo-numérico-ie-da-classe-num">2) Relembre o tipo definido na Ficha 7 para representar expressões inteiras. Uma possível generalização desse tipo de dados, será considerar expressões cujas constantes são de um qualquer tipo numérico (i.e., da classe <code class="language-plaintext highlighter-rouge">Num</code>).</h1>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>data Exp a = Const a
| Simetrico (Exp a)
| Mais (Exp a) (Exp a)
| Menos (Exp a) (Exp a)
| Mult (Exp a) (Exp a)
</code></pre></div></div>

<h2 id="a-declare-exp-a-como-uma-instância-de-show">a) Declare <code class="language-plaintext highlighter-rouge">Exp a</code> como uma instância de <code class="language-plaintext highlighter-rouge">Show</code>.</h2>

<div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">instance</span> <span class="kt">Show</span> <span class="n">a</span> <span class="o">=&gt;</span> <span class="kt">Show</span> <span class="p">(</span><span class="kt">Exp</span> <span class="n">a</span><span class="p">)</span> <span class="kr">where</span>
    <span class="n">show</span> <span class="p">(</span><span class="kt">Const</span> <span class="n">a</span><span class="p">)</span> <span class="o">=</span> <span class="n">show</span> <span class="n">a</span>
    <span class="n">show</span> <span class="p">(</span><span class="kt">Simetrico</span> <span class="n">a</span><span class="p">)</span> <span class="o">=</span> <span class="s">"(- "</span> <span class="o">++</span> <span class="n">show</span> <span class="n">a</span> <span class="o">++</span> <span class="s">")"</span>
    <span class="n">show</span> <span class="p">(</span><span class="kt">Mais</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="s">"("</span> <span class="o">++</span> <span class="n">show</span> <span class="n">a</span> <span class="o">++</span> <span class="s">" + "</span> <span class="o">++</span> <span class="n">show</span> <span class="n">b</span> <span class="o">++</span> <span class="s">")"</span>
    <span class="n">show</span> <span class="p">(</span><span class="kt">Menos</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="s">"("</span> <span class="o">++</span> <span class="n">show</span> <span class="n">a</span> <span class="o">++</span> <span class="s">" - "</span> <span class="o">++</span> <span class="n">show</span> <span class="n">b</span> <span class="o">++</span> <span class="s">")"</span>
    <span class="n">show</span> <span class="p">(</span><span class="kt">Mult</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="s">"("</span> <span class="o">++</span> <span class="n">show</span> <span class="n">a</span> <span class="o">++</span> <span class="s">" * "</span> <span class="o">++</span> <span class="n">show</span> <span class="n">b</span> <span class="o">++</span> <span class="s">")"</span>
</code></pre></div></div>

<h2 id="b-declare-exp-a-como-uma-instância-de-eq">b) Declare <code class="language-plaintext highlighter-rouge">Exp a</code> como uma instância de <code class="language-plaintext highlighter-rouge">Eq</code>.</h2>

<div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">valorDe</span> <span class="o">::</span> <span class="p">(</span><span class="kt">Num</span> <span class="n">a</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="kt">Exp</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="n">a</span>
<span class="n">valorDe</span> <span class="p">(</span><span class="kt">Const</span> <span class="n">a</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span>
<span class="n">valorDe</span> <span class="p">(</span><span class="kt">Simetrico</span> <span class="n">a</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span> <span class="p">(</span><span class="n">valorDe</span> <span class="n">a</span><span class="p">)</span>
<span class="n">valorDe</span> <span class="p">(</span><span class="kt">Mais</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="n">valorDe</span> <span class="n">a</span> <span class="o">+</span> <span class="n">valorDe</span> <span class="n">b</span>
<span class="n">valorDe</span> <span class="p">(</span><span class="kt">Menos</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="n">valorDe</span> <span class="n">a</span> <span class="o">-</span> <span class="n">valorDe</span> <span class="n">b</span>
<span class="n">valorDe</span> <span class="p">(</span><span class="kt">Mult</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="n">valorDe</span> <span class="n">a</span> <span class="o">*</span> <span class="n">valorDe</span> <span class="n">b</span>

<span class="kr">instance</span> <span class="p">(</span><span class="kt">Num</span> <span class="n">a</span><span class="p">,</span><span class="kt">Eq</span> <span class="n">a</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="kt">Eq</span> <span class="p">(</span><span class="kt">Exp</span> <span class="n">a</span><span class="p">)</span> <span class="kr">where</span>
    <span class="n">x</span> <span class="o">==</span> <span class="n">y</span> <span class="o">=</span> <span class="n">valorDe</span> <span class="n">x</span> <span class="o">==</span> <span class="n">valorDe</span> <span class="n">y</span>
</code></pre></div></div>

<h2 id="c-declare-exp-a-como-instância-da-classe-num">c) Declare <code class="language-plaintext highlighter-rouge">Exp a</code> como instância da classe <code class="language-plaintext highlighter-rouge">Num</code>.</h2>

<div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">instance</span> <span class="p">(</span><span class="kt">Num</span> <span class="n">a</span><span class="p">,</span> <span class="kt">Eq</span> <span class="n">a</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="kt">Num</span> <span class="p">(</span><span class="kt">Exp</span> <span class="n">a</span><span class="p">)</span> <span class="kr">where</span>
    <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">=</span> <span class="kt">Const</span> <span class="p">(</span><span class="n">valorDe</span> <span class="n">x</span> <span class="o">+</span> <span class="n">valorDe</span> <span class="n">y</span><span class="p">)</span>
    <span class="c1">--</span>
    <span class="n">x</span> <span class="o">-</span> <span class="n">y</span> <span class="o">=</span> <span class="kt">Const</span> <span class="p">(</span><span class="n">valorDe</span> <span class="n">x</span> <span class="o">-</span> <span class="n">valorDe</span> <span class="n">y</span><span class="p">)</span>
    <span class="c1">--</span>
    <span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="o">=</span> <span class="kt">Const</span> <span class="p">(</span><span class="n">valorDe</span> <span class="n">x</span> <span class="o">*</span> <span class="n">valorDe</span> <span class="n">y</span><span class="p">)</span>
    <span class="c1">--</span>
    <span class="n">negate</span> <span class="p">(</span><span class="kt">Const</span> <span class="n">a</span><span class="p">)</span> <span class="o">=</span> <span class="kt">Const</span> <span class="p">(</span><span class="o">-</span> <span class="n">a</span><span class="p">)</span>
    <span class="n">negate</span> <span class="p">(</span><span class="kt">Simetrico</span> <span class="n">a</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span>
    <span class="n">negate</span> <span class="p">(</span><span class="kt">Mais</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="kt">Mais</span> <span class="p">(</span><span class="o">-</span> <span class="n">a</span><span class="p">)</span> <span class="p">(</span><span class="o">-</span> <span class="n">b</span><span class="p">)</span>
    <span class="n">negate</span> <span class="p">(</span><span class="kt">Menos</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="kt">Menos</span> <span class="n">b</span> <span class="n">a</span>
    <span class="n">negate</span> <span class="p">(</span><span class="kt">Mult</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="kt">Mult</span> <span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="p">)</span> <span class="n">b</span>
    <span class="n">fromInteger</span> <span class="n">x</span> <span class="o">=</span> <span class="kt">Const</span> <span class="p">(</span><span class="n">fromInteger</span> <span class="n">x</span><span class="p">)</span>
    <span class="n">abs</span> <span class="p">(</span><span class="kt">Const</span> <span class="n">a</span><span class="p">)</span> <span class="o">=</span> <span class="kt">Const</span> <span class="p">(</span><span class="n">abs</span> <span class="n">a</span><span class="p">)</span>
    <span class="n">abs</span> <span class="p">(</span><span class="kt">Simetrico</span> <span class="n">a</span><span class="p">)</span> <span class="o">=</span> <span class="n">abs</span> <span class="n">a</span>
    <span class="n">abs</span> <span class="p">(</span><span class="kt">Mais</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="n">abs</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>
    <span class="n">abs</span> <span class="p">(</span><span class="kt">Menos</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="n">abs</span> <span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span>
    <span class="n">abs</span> <span class="p">(</span><span class="kt">Mult</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="n">abs</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span>
    <span class="n">signum</span> <span class="p">(</span><span class="kt">Const</span> <span class="n">a</span><span class="p">)</span> <span class="o">=</span> <span class="kt">Const</span> <span class="p">(</span><span class="kr">if</span> <span class="n">abs</span> <span class="n">a</span> <span class="o">==</span> <span class="n">a</span> <span class="kr">then</span> <span class="kr">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">0</span> <span class="kr">then</span> <span class="mi">0</span> <span class="kr">else</span> <span class="mi">1</span> <span class="kr">else</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">signum</span> <span class="p">(</span><span class="kt">Simetrico</span> <span class="n">a</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span> <span class="n">signum</span> <span class="n">a</span>
    <span class="n">signum</span> <span class="p">(</span><span class="kt">Mais</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="kt">Const</span> <span class="p">(</span><span class="kr">if</span> <span class="n">abs</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="o">==</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="kr">then</span> <span class="kr">if</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span> <span class="kr">then</span> <span class="mi">0</span> <span class="kr">else</span> <span class="mi">1</span> <span class="kr">else</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">signum</span> <span class="p">(</span><span class="kt">Menos</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="kt">Const</span> <span class="p">(</span><span class="kr">if</span> <span class="n">abs</span> <span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">==</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span> <span class="kr">then</span> <span class="kr">if</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span> <span class="kr">then</span> <span class="mi">0</span> <span class="kr">else</span> <span class="mi">1</span> <span class="kr">else</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">signum</span> <span class="p">(</span><span class="kt">Mult</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="kt">Const</span> <span class="p">(</span><span class="kr">if</span> <span class="n">abs</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span> <span class="o">==</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span> <span class="kr">then</span> <span class="kr">if</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span> <span class="kr">then</span> <span class="mi">0</span> <span class="kr">else</span> <span class="mi">1</span> <span class="kr">else</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
</code></pre></div></div>

<h1 id="3-relembre-o-exercício-da-ficha-3-sobre-contas-bancárias-com-a-seguinte-declaração-de-tipos">3) Relembre o exercício da Ficha 3 sobre contas bancárias, com a seguinte declaração de tipos:</h1>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>data Movimento = Credito Float | Debito Float
data Data = D Int Int Int
data Extracto = Ext Float [(Data, String, Movimento)]
</code></pre></div></div>

<h2 id="a-defina-data-como-instância-da-classe-ord">a) Defina <code class="language-plaintext highlighter-rouge">Data</code> como instância da classe <code class="language-plaintext highlighter-rouge">Ord</code>.</h2>

<div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">instance</span> <span class="kt">Ord</span> <span class="kt">Data</span> <span class="kr">where</span>
    <span class="n">compare</span> <span class="p">(</span><span class="kt">D</span> <span class="n">dia1</span> <span class="n">mes1</span> <span class="n">ano1</span><span class="p">)</span> <span class="p">(</span><span class="kt">D</span> <span class="n">dia2</span> <span class="n">mes2</span> <span class="n">ano2</span><span class="p">)</span> 
        <span class="o">|</span> <span class="n">ano1</span> <span class="o">&gt;</span> <span class="n">ano2</span> <span class="o">||</span> <span class="n">ano1</span> <span class="o">==</span> <span class="n">ano2</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">mes1</span> <span class="o">&gt;</span> <span class="n">mes2</span> <span class="o">||</span> <span class="n">mes1</span> <span class="o">==</span> <span class="n">mes2</span> <span class="o">&amp;&amp;</span> <span class="n">dia1</span> <span class="o">&gt;</span> <span class="n">dia2</span><span class="p">)</span> <span class="o">=</span> <span class="kt">GT</span>
        <span class="o">|</span> <span class="n">ano1</span> <span class="o">==</span> <span class="n">ano2</span> <span class="o">&amp;&amp;</span> <span class="n">mes1</span> <span class="o">==</span> <span class="n">mes2</span> <span class="o">&amp;&amp;</span> <span class="n">dia1</span> <span class="o">==</span> <span class="n">dia2</span> <span class="o">=</span> <span class="kt">EQ</span>
        <span class="o">|</span> <span class="n">otherwise</span> <span class="o">=</span> <span class="kt">LT</span>
</code></pre></div></div>

<h2 id="b-defina-data-como-instância-da-classe-show">b) Defina <code class="language-plaintext highlighter-rouge">Data</code> como instância da classe <code class="language-plaintext highlighter-rouge">Show</code>.</h2>

<div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">instance</span> <span class="kt">Show</span> <span class="kt">Data</span> <span class="kr">where</span> 
    <span class="n">show</span> <span class="p">(</span><span class="kt">D</span> <span class="n">dia</span> <span class="n">mes</span> <span class="n">ano</span><span class="p">)</span> <span class="o">=</span> <span class="n">intercalate</span> <span class="s">"/"</span> <span class="o">$</span> <span class="n">map</span> <span class="n">show</span> <span class="p">[</span><span class="n">dia</span><span class="p">,</span><span class="n">mes</span><span class="p">,</span><span class="n">ano</span><span class="p">]</span>
</code></pre></div></div>

<h2 id="c-defina-a-função-ordena--extracto---extracto-que-transforma-um-extrato-de-modo-a-que-a-lista-de-movimentos-apareça-ordenada-por-ordem-crescente-de-data">c) Defina a função <code class="language-plaintext highlighter-rouge">ordena :: Extracto -&gt; Extracto</code>, que transforma um extrato de modo a que a lista de movimentos apareça ordenada por ordem crescente de data.</h2>

<div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ordena</span> <span class="o">::</span> <span class="kt">Extracto</span> <span class="o">-&gt;</span> <span class="kt">Extracto</span>
<span class="n">ordena</span> <span class="p">(</span><span class="kt">Ext</span> <span class="n">n</span> <span class="n">l</span><span class="p">)</span> <span class="o">=</span> <span class="kt">Ext</span> <span class="n">n</span> <span class="p">(</span><span class="n">sort</span> <span class="n">l</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="d-defina-extracto-como-instância-da-classe-show-de-forma-a-que-a-apresentação-do-extracto-seja-por-ordem-de-data-do-movimento-com-o-seguinte-aspeto">d) Defina <code class="language-plaintext highlighter-rouge">Extracto</code> como instância da classe <code class="language-plaintext highlighter-rouge">Show</code> de forma a que a apresentação do extracto seja por ordem de data do movimento, com o seguinte aspeto:</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Saldo anterior: 300
---------------------------------------
Data Descricao Credito Debito
---------------------------------------
2010/4/5 DEPOSITO 2000
2010/8/10 COMPRA 37,5
2010/9/1 LEV 60
2011/1/7 JUROS 100
2011/1/22 ANUIDADE 8
---------------------------------------
Saldo atual: 2294,5
</code></pre></div></div>

<div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">saldo</span> <span class="o">::</span> <span class="kt">Extracto</span> <span class="o">-&gt;</span> <span class="kt">Float</span>
<span class="n">saldo</span> <span class="p">(</span><span class="kt">Ext</span> <span class="n">x</span> <span class="n">lm</span><span class="p">)</span> <span class="o">=</span> <span class="n">foldl</span> <span class="p">(</span><span class="nf">\</span><span class="n">acc</span> <span class="p">(</span><span class="kr">_</span><span class="p">,</span><span class="kr">_</span><span class="p">,</span><span class="n">mov</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kr">case</span> <span class="n">mov</span> <span class="kr">of</span> <span class="kt">Credito</span> <span class="n">n</span> <span class="o">-&gt;</span> <span class="n">acc</span> <span class="o">+</span> <span class="n">n</span><span class="p">;</span> <span class="kt">Debito</span> <span class="n">n</span> <span class="o">-&gt;</span> <span class="n">acc</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span> <span class="n">x</span> <span class="n">lm</span>

<span class="kr">instance</span> <span class="kt">Show</span> <span class="kt">Extracto</span> <span class="kr">where</span>
    <span class="n">show</span> <span class="p">(</span><span class="kt">Ext</span> <span class="n">n</span> <span class="n">l</span><span class="p">)</span> <span class="o">=</span> <span class="s">"Saldo anterior: "</span> <span class="o">++</span> <span class="n">show</span> <span class="n">n</span> <span class="o">++</span>
                     <span class="s">"</span><span class="se">\n</span><span class="s">---------------------------------------"</span> <span class="o">++</span>
                     <span class="s">"</span><span class="se">\n</span><span class="s">Data       Descricao   Credito   Debito"</span> <span class="o">++</span>
                     <span class="s">"</span><span class="se">\n</span><span class="s">---------------------------------------</span><span class="se">\n</span><span class="s">"</span> <span class="o">++</span> <span class="n">concatMap</span> <span class="p">(</span><span class="nf">\</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span><span class="n">str</span><span class="p">,</span><span class="kr">_</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">show</span> <span class="n">dat</span> <span class="o">++</span> <span class="n">replicate</span> <span class="p">(</span><span class="mi">11</span> <span class="o">-</span> <span class="n">length</span> <span class="p">(</span><span class="n">show</span> <span class="n">dat</span><span class="p">))</span> <span class="sc">' '</span> <span class="o">++</span> <span class="n">map</span> <span class="n">toUpper</span> <span class="n">str</span> <span class="o">++</span> <span class="s">"    </span><span class="se">\n</span><span class="s">"</span><span class="p">)</span> <span class="n">l</span> <span class="o">++</span>
                     <span class="s">"---------------------------------------"</span> <span class="o">++</span>
                     <span class="s">"</span><span class="se">\n</span><span class="s">Saldo atual: "</span> <span class="o">++</span> <span class="n">show</span> <span class="p">(</span><span class="n">saldo</span> <span class="p">(</span><span class="kt">Ext</span> <span class="n">n</span> <span class="n">l</span><span class="p">))</span>
</code></pre></div></div>

  </div>
</div>
      </div>
      <footer class="bg-dark-gray p-8 lg:px-14 flex flex-col md:flex-row gap-6 justify-between items-center justify-self-end">
        <p>Made with 💙 by <a href="https://github.com/RisingFisan" target="_blank" rel="noopener noreferrer">RisingFisan</a>.</p>
        <p class="inline">If you want to support this project, you can <a href="https://paypal.me/sofirs" target="_blank" rel="noopener noreferrer">buy me a coffee <svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="paypal" class="w-4 inline" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M111.4 295.9c-3.5 19.2-17.4 108.7-21.5 134-.3 1.8-1 2.5-3 2.5H12.3c-7.6 0-13.1-6.6-12.1-13.9L58.8 46.6c1.5-9.6 10.1-16.9 20-16.9 152.3 0 165.1-3.7 204 11.4 60.1 23.3 65.6 79.5 44 140.3-21.5 62.6-72.5 89.5-140.1 90.3-43.4.7-69.5-7-75.3 24.2zM357.1 152c-1.8-1.3-2.5-1.8-3 1.3-2 11.4-5.1 22.5-8.8 33.6-39.9 113.8-150.5 103.9-204.5 103.9-6.1 0-10.1 3.3-10.9 9.4-22.6 140.4-27.1 169.7-27.1 169.7-1 7.1 3.5 12.9 10.6 12.9h63.5c8.6 0 15.7-6.3 17.4-14.9.7-5.4-1.1 6.1 14.4-91.3 4.6-22 14.3-19.7 29.3-19.7 71 0 126.4-28.8 142.9-112.3 6.5-34.8 4.6-71.4-23.8-92.6z"></path></svg></a>! 😁☕</p>
      </footer>
    </div>
  </body>
</html>
